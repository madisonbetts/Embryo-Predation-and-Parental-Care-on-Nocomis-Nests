geom_smooth(method = "loess", span = 0.75, se = TRUE, color = "black") +
labs(
title = "Mortality vs. Associated Abundance",
x = "Associated Abundance",
y = "Mortality"
) +
theme_minimal(base_size = 14)
# optional: subset and compare groups
# create combined groups as needed
up <- predation_s[which(predation_s$hpos=='up'),]
mid <- predation_s[which(predation_s$hpos=='mid'),]
down <- predation_s[which(predation_s$hpos=='down'),]
upmid <- filter(predation, hpos %in% c("up", "mid")) %>% arrange(assoc_abund)
updown <- filter(predation, hpos %in% c("up", "down")) %>% arrange(assoc_abund)
# example plots for these combined groups
ggplot(upmid, aes(x = assoc_abund, y = mortality)) +
geom_point(alpha = 0.6, color = "purple") +
geom_smooth(method = "loess", span = 0.75, se = FALSE, color = "black") +
labs(title = "Up + Mid Positions", x = "Associated Abundance", y = "Mortality") +
theme_minimal(base_size = 14)
ggplot(updown, aes(x = assoc_abund, y = mortality)) +
geom_point(alpha = 0.6, color = "darkgreen") +
geom_smooth(method = "loess", span = 0.75, se = FALSE, color = "black") +
labs(title = "Up + Down Positions", x = "Associated Abundance", y = "Mortality") +
theme_minimal(base_size = 14)
pred0 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID), family=binomial(link="logit"), data=predation)
pred1 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID)+ assoc_abund + hpos + subsample,
family=binomial(link="logit"), data=predation)
pred2 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID)+ hpos + subsample,
family=binomial(link="logit"), data=predation)
pred3 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID)+ assoc_abund + subsample,
family=binomial(link="logit"), data=predation)
summary(pred0)
summary(pred1)
summary(pred2)
summary(pred3)
pred01 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID), family=binomial(link="logit"), data=updown)
pred11 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID)+ assoc_abund + hpos + subsample,
family=binomial(link="logit"), data=updown)
summary(pred11)
pred02 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID),
family=binomial(link="logit"), data=up)
pred12 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID)+ assoc_abund +
subsample,
family=binomial(link="logit"), data=up)
summary(pred12)
Cand.models <- list(pred0,pred1,pred2,pred3)
Modnames <- c("Null Model", "Full Model", "No assoc abundance Model", "No horizontal position Model")
print(aictab(cand.set = Cand.models, modnames = Modnames, second.ord = TRUE), digits = 2)
# Check singularity
cat("Singularity check embryo predation models:", sapply(Cand.models, isSingular), "\n")
ggplot(predation, aes(x = factor(hpos), y = pct_mort)) +
geom_boxplot(fill = "blueviolet", color = "black") +
labs(title = "Egg mortality by horizontal position",
x = "Horizontal position",
y = "Egg mortality (%)") +
theme_classic() +
theme(text = element_text(size = 18),
axis.text = element_text(size = 18),
axis.title = element_text(size = 18),
plot.title = element_text(size = 18))
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 6)
# Install required packages (run once)
packages <- c("ggplot2", "dplyr", "AICcmodavg", "lme4")
# Check if packages are installed, install if not
new_packages <- packages[!(packages %in% installed.packages()[,"Package"])]
if(length(new_packages)) install.packages(new_packages)
# Load all packages
library(ggplot2)
library(dplyr)
library(AICcmodavg)
library(lme4)
# Set options
options(prompt = "=")
# Read in csv files and sort data
predation <- read.csv("eggstealing2023.csv")
predation_s <- predation[order(predation$assoc_abund), ]
# plot mortality trend
ggplot(predation_s, aes(x = seq_along(mortality), y = mortality)) +
geom_point(color = "darkgrey") +
geom_smooth(method = "loess", span = 0.75, se = FALSE, color = "blue") +
labs(
title = "Smoothed Mortality (ordered by assoc_abund)",
x = "Observation index (sorted)",
y = "Mortality"
) +
theme_minimal(base_size = 14)
# plot mortality vs. associate abundance
ggplot(predation_s, aes(x = assoc_abund, y = mortality)) +
geom_point(color = "purple", alpha = 0.7, size = 2) +
geom_smooth(method = "loess", span = 0.75, se = TRUE, color = "black") +
labs(
title = "Mortality vs. Associated Abundance",
x = "Associated Abundance",
y = "Mortality"
) +
theme_minimal(base_size = 14)
# optional: subset and compare groups
# create combined groups as needed
up <- predation_s[which(predation_s$hpos=='up'),]
mid <- predation_s[which(predation_s$hpos=='mid'),]
down <- predation_s[which(predation_s$hpos=='down'),]
upmid <- filter(predation, hpos %in% c("up", "mid")) %>% arrange(assoc_abund)
updown <- filter(predation, hpos %in% c("up", "down")) %>% arrange(assoc_abund)
# example plots for these combined groups
ggplot(upmid, aes(x = assoc_abund, y = mortality)) +
geom_point(alpha = 0.6, color = "purple") +
geom_smooth(method = "loess", span = 0.75, se = FALSE, color = "black") +
labs(title = "Up + Mid Positions", x = "Associated Abundance", y = "Mortality") +
theme_minimal(base_size = 14)
ggplot(updown, aes(x = assoc_abund, y = mortality)) +
geom_point(alpha = 0.6, color = "darkgreen") +
geom_smooth(method = "loess", span = 0.75, se = FALSE, color = "black") +
labs(title = "Up + Down Positions", x = "Associated Abundance", y = "Mortality") +
theme_minimal(base_size = 14)
pred0 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID), family=binomial(link="logit"), data=predation)
pred1 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID)+ assoc_abund + hpos + (1|subsample),
family=binomial(link="logit"), data=predation)
pred2 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID)+ hpos + (1|subsample),
family=binomial(link="logit"), data=predation)
pred3 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID)+ assoc_abund + (1|subsample),
family=binomial(link="logit"), data=predation)
summary(pred0)
summary(pred1)
summary(pred2)
summary(pred3)
pred01 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID), family=binomial(link="logit"), data=updown)
pred11 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID)+ assoc_abund + hpos + (1|subsample),
family=binomial(link="logit"), data=updown)
summary(pred11)
pred02 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID),
family=binomial(link="logit"), data=up)
pred12 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID)+ assoc_abund +
(1|subsample),
family=binomial(link="logit"), data=up)
summary(pred12)
Cand.models <- list(pred0,pred1,pred2,pred3)
Modnames <- c("Null Model", "Full Model", "No assoc abundance Model", "No horizontal position Model")
print(aictab(cand.set = Cand.models, modnames = Modnames, second.ord = TRUE), digits = 2)
# Check singularity
cat("Singularity check embryo predation models:", sapply(Cand.models, isSingular), "\n")
ggplot(predation, aes(x = factor(hpos), y = pct_mort)) +
geom_boxplot(fill = "blueviolet", color = "black") +
labs(title = "Egg mortality by horizontal position",
x = "Horizontal position",
y = "Egg mortality (%)") +
theme_classic() +
theme(text = element_text(size = 18),
axis.text = element_text(size = 18),
axis.title = element_text(size = 18),
plot.title = element_text(size = 18))
summary(pred1)
setwd("~/GitHub/Embryo-Predation-and-Parental-Care-on-Nocomis-Nests/Exp A")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 6)
#create Figure 3
ggplot(data, aes(x = hpos, y = percentsurvival, fill = ypos)) +
geom_boxplot(color = "black", position = position_dodge(width = 0.8)) +
scale_fill_manual(values = c("buried" = "grey80", "unburied" = "grey40")) +
labs(x = "Pouch Location",
y = "Embryo Survival (%)",
fill = "") +
theme_bw() +
theme(
text = element_text(family = "Arial", size = 14),
axis.title = element_text(family = "Arial", size = 16),
axis.text = element_text(family = "Arial", size = 14),
legend.position = "bottom",
legend.text = element_text(family = "Arial", size = 14)
)
# Read in excel sheet
data <- read_excel("parentalcare_data.xlsx")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 6)
# Install required packages (run once)
packages <- c("readxl", "ggplot2", "dplyr")
# Check if packages are installed, install if not
new_packages <- packages[!(packages %in% installed.packages()[,"Package"])]
if(length(new_packages)) install.packages(new_packages)
# Load all packages
library(readxl)      # For reading Excel files
library(ggplot2)     # For visualization
library(dplyr)       # For data manipulation
# Set options
options(prompt = "=")
# Read in excel sheet
data <- read_excel("parentalcare_data.xlsx")
#create Figure 3
ggplot(data, aes(x = hpos, y = percentsurvival, fill = ypos)) +
geom_boxplot(color = "black", position = position_dodge(width = 0.8)) +
scale_fill_manual(values = c("buried" = "grey80", "unburied" = "grey40")) +
labs(x = "Pouch Location",
y = "Embryo Survival (%)",
fill = "") +
theme_bw() +
theme(
text = element_text(family = "Arial", size = 14),
axis.title = element_text(family = "Arial", size = 16),
axis.text = element_text(family = "Arial", size = 14),
legend.position = "bottom",
legend.text = element_text(family = "Arial", size = 14)
)
#create Figure 3
ggplot(data, aes(x = hpos, y = percentsurvival, fill = vpos)) +
geom_boxplot(color = "black", position = position_dodge(width = 0.8)) +
scale_fill_manual(values = c("buried" = "grey80", "unburied" = "grey40")) +
labs(x = "Pouch Location",
y = "Embryo Survival (%)",
fill = "") +
theme_bw() +
theme(
text = element_text(family = "Arial", size = 14),
axis.title = element_text(family = "Arial", size = 16),
axis.text = element_text(family = "Arial", size = 14),
legend.position = "bottom",
legend.text = element_text(family = "Arial", size = 14)
)
data$hpos <- factor(predation$hpos,
levels = c("upstream", "middle", "downstream"))
#create Figure 3
data$hpos <- factor(data$hpos,
levels = c("up", "mid", "down"),
labels = c("upstream", "middle", "downstream"))
fig3 <- ggplot(data, aes(x = hpos, y = percentsurvival, fill = vpos)) +
geom_boxplot(color = "black", position = position_dodge(width = 0.8)) +
scale_fill_manual(values = c("buried" = "grey80", "unburied" = "grey40")) +
labs(x = "Pouch Location",
y = "Embroyo Survival (%)",
fill = "") +
theme_bw() +
theme(
text = element_text(family = "Arial", size = 14),
axis.title = element_text(family = "Arial", size = 16),
axis.text = element_text(family = "Arial", size = 14),
legend.position = "bottom",
legend.text = element_text(family = "Arial", size = 14)
)
fig3
fig3 <- ggplot(data, aes(x = hpos, y = percentsurvival, fill = vpos)) +
geom_boxplot(color = "black", position = position_dodge(width = 0.8)) +
scale_fill_manual(values = c("buried" = "grey80", "unburied" = "grey40")) +
labs(x = "Pouch Location",
y = "Embryo Survival (%)",
fill = "") +
theme_bw() +
theme(
text = element_text(family = "Arial", size = 14),
axis.title = element_text(family = "Arial", size = 16),
axis.text = element_text(family = "Arial", size = 14),
legend.position = "bottom",
legend.text = element_text(family = "Arial", size = 14),
panel.grid.major = element_blank(),   # removes major grid lines
panel.grid.minor = element_blank()    # removes minor grid lines
)
fig3
ggsave("Figure3.tiff",
plot = fig3,
dpi = 600,
width = 6, height = 5, units = "in",
device = "tiff",
compression = "lzw")
setwd("~/GitHub/Embryo-Predation-and-Parental-Care-on-Nocomis-Nests/Exp C")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 6)
# Install required packages (run once)
packages <- c("ggplot2", "dplyr", "AICcmodavg", "lme4")
# Check if packages are installed, install if not
new_packages <- packages[!(packages %in% installed.packages()[,"Package"])]
if(length(new_packages)) install.packages(new_packages)
# Load all packages
library(ggplot2)
library(dplyr)
library(AICcmodavg)
library(lme4)
# Set options
options(prompt = "=")
# Read in csv files and sort data
predation <- read.csv("nestattendance_data.csv")
predation_s <- predation[order(predation$assoc_abund), ]
# plot mortality trend
ggplot(predation_s, aes(x = seq_along(mortality), y = mortality)) +
geom_point(color = "darkgrey") +
geom_smooth(method = "loess", span = 0.75, se = FALSE, color = "blue") +
labs(
title = "Smoothed Mortality (ordered by assoc_abund)",
x = "Observation index (sorted)",
y = "Mortality"
) +
theme_minimal(base_size = 14)
# plot mortality vs. associate abundance
ggplot(predation_s, aes(x = assoc_abund, y = mortality)) +
geom_point(color = "purple", alpha = 0.7, size = 2) +
geom_smooth(method = "loess", span = 0.75, se = TRUE, color = "black") +
labs(
title = "Mortality vs. Associated Abundance",
x = "Associated Abundance",
y = "Mortality"
) +
theme_minimal(base_size = 14)
# optional: subset and compare groups
# create combined groups as needed
up <- predation_s[which(predation_s$hpos=='up'),]
mid <- predation_s[which(predation_s$hpos=='mid'),]
down <- predation_s[which(predation_s$hpos=='down'),]
upmid <- filter(predation, hpos %in% c("up", "mid")) %>% arrange(assoc_abund)
updown <- filter(predation, hpos %in% c("up", "down")) %>% arrange(assoc_abund)
# example plots for these combined groups
ggplot(upmid, aes(x = assoc_abund, y = mortality)) +
geom_point(alpha = 0.6, color = "purple") +
geom_smooth(method = "loess", span = 0.75, se = FALSE, color = "black") +
labs(title = "Up + Mid Positions", x = "Associated Abundance", y = "Mortality") +
theme_minimal(base_size = 14)
ggplot(updown, aes(x = assoc_abund, y = mortality)) +
geom_point(alpha = 0.6, color = "darkgreen") +
geom_smooth(method = "loess", span = 0.75, se = FALSE, color = "black") +
labs(title = "Up + Down Positions", x = "Associated Abundance", y = "Mortality") +
theme_minimal(base_size = 14)
pred0 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID), family=binomial(link="logit"), data=predation)
pred1 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID)+ assoc_abund + hpos + (1|subsample),
family=binomial(link="logit"), data=predation)
pred2 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID)+ hpos + (1|subsample),
family=binomial(link="logit"), data=predation)
pred3 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID)+ assoc_abund + (1|subsample),
family=binomial(link="logit"), data=predation)
summary(pred0)
summary(pred1)
summary(pred2)
summary(pred3)
pred01 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID), family=binomial(link="logit"), data=updown)
pred11 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID)+ assoc_abund + hpos + (1|subsample),
family=binomial(link="logit"), data=updown)
summary(pred11)
pred02 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID),
family=binomial(link="logit"), data=up)
pred12 <- glmer(cbind(mortality, bait_ct-mortality) ~ (1|nestID)+ assoc_abund +
(1|subsample),
family=binomial(link="logit"), data=up)
summary(pred12)
Cand.models <- list(pred0,pred1,pred2,pred3)
Modnames <- c("Null Model", "Full Model", "No assoc abundance Model", "No horizontal position Model")
print(aictab(cand.set = Cand.models, modnames = Modnames, second.ord = TRUE), digits = 2)
# Check singularity
cat("Singularity check embryo predation models:", sapply(Cand.models, isSingular), "\n")
ggplot(predation, aes(x = factor(hpos), y = pct_mort)) +
geom_boxplot(fill = "blueviolet", color = "black") +
labs(title = "Egg mortality by horizontal position",
x = "Horizontal position",
ggplot(predation, aes(x = factor(hpos), y = pct_mort)) +
labs(title = "Egg mortality by horizontal position",
ggplot(predation, aes(x = factor(hpos), y = pct_mort)) +
geom_boxplot(fill = "blueviolet", color = "black") +
labs(title = "Egg mortality by horizontal position",
x = "Horizontal position",
))
ggplot(predation, aes(x = factor(hpos), y = pct_mort)) +
geom_boxplot(fill = "blueviolet", color = "black") +
labs(title = "Egg mortality by horizontal position",
x = "Horizontal position", y = "Embryo Mortality"
))
ggplot(predation, aes(x = factor(hpos), y = pct_mort)) +
geom_boxplot(fill = "blueviolet", color = "black") +
labs(title = "Egg mortality by horizontal position",
x = "Horizontal position", y = "Embryo Mortality"
))
ggplot(predation, aes(x = factor(hpos), y = pct_mort)) +
geom_boxplot(fill = "blueviolet", color = "black") +
labs(title = "Egg mortality by horizontal position",
x = "Horizontal position", y = "Embryo Mortality"
)
plot1 <- data.frame(
location = rep(c("up", "mid", "down"), each = 30),
survival = c(
rnorm(30, mean = 85, sd = 15),
c(rnorm(15, mean = 90, sd = 8), rnorm(15, mean = 40, sd = 25)),
c(rnorm(20, mean = 85, sd = 20), rnorm(10, mean = 20, sd = 20))
)
)
predation$pct_surv <- pmax(0, pmin(100, predation$pct_surv))
# Recode location values and set factor order
predation$location <- factor(predation$hpos,
levels = c("up", "mid", "down"),
labels = c("upstream", "middle", "downstream"))
# Create the plot
ggplot(predation, aes(x = hpos, y = pct_surv)) +
geom_boxplot(fill = "white", color = "black", linewidth = 0.8) +
scale_y_continuous(
limits = c(0, 105),
breaks = seq(0, 100, 25),
expand = c(0, 0)
) +
labs(
x = "Pouch Location",
y = "Embryo Survival (%)"
) +
theme_classic() +
theme(
axis.title = element_text(size = 12, color = "black"),
axis.text = element_text(size = 11, color = "black"),
axis.line = element_line(color = "black", linewidth = 0.8),
axis.ticks = element_line(color = "black", linewidth = 0.8),
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "white", color = NA)
)
plot1 <- data.frame(
location = rep(c("up", "mid", "down"), each = 30),
survival = c(
rnorm(30, mean = 85, sd = 15),
c(rnorm(15, mean = 90, sd = 8), rnorm(15, mean = 40, sd = 25)),
c(rnorm(20, mean = 85, sd = 20), rnorm(10, mean = 20, sd = 20))
)
)
predation$pct_surv <- pmax(0, pmin(100, predation$pct_surv))
# Recode location values and set factor order
predation$location <- factor(predation$hpos,
levels = c("up", "mid", "down"),
labels = c("upstream", "middle", "downstream"))
# Create the plot - USE THE NEW location COLUMN, NOT hpos
ggplot(predation, aes(x = location, y = pct_surv)) +
geom_boxplot(fill = "white", color = "black", linewidth = 0.8) +
scale_y_continuous(
limits = c(0, 105),
breaks = seq(0, 100, 25),
expand = c(0, 0)
) +
labs(
x = "Pouch Location",
y = "Embryo Survival (%)"
) +
theme_classic() +
theme(
text = element_text(family = "Arial"),
axis.title = element_text(size = 12, color = "black", family = "Arial"),
axis.text = element_text(size = 11, color = "black", family = "Arial"),
axis.line = element_line(color = "black", linewidth = 0.8),
axis.ticks = element_line(color = "black", linewidth = 0.8),
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "white", color = NA)
)
plot1 <- data.frame(
location = rep(c("up", "mid", "down"), each = 30),
survival = c(
rnorm(30, mean = 85, sd = 15),
c(rnorm(15, mean = 90, sd = 8), rnorm(15, mean = 40, sd = 25)),
c(rnorm(20, mean = 85, sd = 20), rnorm(10, mean = 20, sd = 20))
)
)
predation$pct_surv <- pmax(0, pmin(100, predation$pct_surv))
# Recode location values and set factor order
predation$location <- factor(predation$hpos,
levels = c("up", "mid", "down"),
labels = c("upstream", "middle", "downstream"))
# Create the plot - USE THE NEW location COLUMN, NOT hpos
ggplot(predation, aes(x = location, y = pct_surv)) +
geom_boxplot(fill = "white", color = "black", linewidth = 0.8) +
scale_y_continuous(
limits = c(-2, 105),
breaks = seq(0, 100, 25),
expand = c(0, 0)
) +
labs(
x = "Pouch Location",
y = "Embryo Survival (%)"
) +
theme_classic() +
theme(
text = element_text(family = "Arial"),
axis.title = element_text(size = 12, color = "black", family = "Arial"),
axis.text = element_text(size = 11, color = "black", family = "Arial"),
axis.line = element_line(color = "black", linewidth = 0.8),
axis.ticks = element_line(color = "black", linewidth = 0.8),
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "white", color = NA)
)
plot1 <- data.frame(
location = rep(c("up", "mid", "down"), each = 30),
survival = c(
rnorm(30, mean = 85, sd = 15),
c(rnorm(15, mean = 90, sd = 8), rnorm(15, mean = 40, sd = 25)),
c(rnorm(20, mean = 85, sd = 20), rnorm(10, mean = 20, sd = 20))
)
)
predation$pct_surv <- pmax(0, pmin(100, predation$pct_surv))
# Recode location values and set factor order
predation$location <- factor(predation$hpos,
levels = c("up", "mid", "down"),
labels = c("upstream", "middle", "downstream"))
# Create the plot - USE THE NEW location COLUMN, NOT hpos
plotS1 <- ggplot(predation, aes(x = location, y = pct_surv)) +
geom_boxplot(fill = "white", color = "black", linewidth = 0.8) +
scale_y_continuous(
limits = c(-2, 105),
breaks = seq(0, 100, 25),
expand = c(0, 0)
) +
labs(
x = "Pouch Location",
y = "Embryo Survival (%)"
) +
theme_classic() +
theme(
text = element_text(family = "Arial"),
axis.title = element_text(size = 12, color = "black", family = "Arial"),
axis.text = element_text(size = 11, color = "black", family = "Arial"),
axis.line = element_line(color = "black", linewidth = 0.8),
axis.ticks = element_line(color = "black", linewidth = 0.8),
panel.background = element_rect(fill = "white", color = NA),
plot.background = element_rect(fill = "white", color = NA)
)
ggsave("FigureS1AppendixS4.tiff",
plot = plotS1,
dpi = 600,
width = 6, height = 5, units = "in",
device = "tiff",
compression = "lzw")
plotS1
