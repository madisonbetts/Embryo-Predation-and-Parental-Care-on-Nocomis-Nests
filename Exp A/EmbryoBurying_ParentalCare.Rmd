---
title: "Generating plots for parental care analysis"
author: "MB"
date: '2025-11-11'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 6)
```

Load required packages

```{r packages, results='hide'}
# Install required packages (run once)
packages <- c("readxl", "ggplot2", "dplyr")
# Check if packages are installed, install if not
new_packages <- packages[!(packages %in% installed.packages()[,"Package"])]
if(length(new_packages)) install.packages(new_packages)

# Load all packages
library(readxl)     
library(ggplot2)    
library(dplyr)      

# Set options
options(prompt = "=")
```

Read your data

```{r data-import}
# Read in excel sheet
data <- read_excel("parentalcare_data.xlsx")

```

Create plots

```{r plots}
#create Figure 3
data$hpos <- factor(data$hpos,
                         levels = c("up", "mid", "down"),
                         labels = c("upstream", "middle", "downstream"))

fig3 <- ggplot(data, aes(x = hpos, y = percentsurvival, fill = vpos)) +
  geom_boxplot(color = "black", position = position_dodge(width = 0.8)) +
  scale_fill_manual(values = c("buried" = "grey80", "unburied" = "grey40")) +
  labs(x = "Pouch Location",
       y = "Embryo Survival (%)",
       fill = "") +
  theme_bw() +
  theme(
    text = element_text(family = "Arial", size = 14),
    axis.title = element_text(family = "Arial", size = 16),
    axis.text = element_text(family = "Arial", size = 14),
    legend.position = "bottom",
    legend.text = element_text(family = "Arial", size = 14),
    panel.grid.major = element_blank(),   # removes major grid lines
    panel.grid.minor = element_blank()    # removes minor grid lines
  )

fig3

ggsave("Figure3.tiff",
       plot = fig3,
       dpi = 600,
       width = 6, height = 5, units = "in",
       device = "tiff",
       compression = "lzw")

```
